<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Reprodutseeritav andmeanalüüs kasutades R programmi</title>
  <meta name="description" content="Praktilise kursuse ‘Reprodutseeritav andmeanalüüs kasutades R programmi’ materjalid.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Reprodutseeritav andmeanalüüs kasutades R programmi" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Praktilise kursuse ‘Reprodutseeritav andmeanalüüs kasutades R programmi’ materjalid." />
  <meta name="github-repo" content="rstats-tartu/lectures" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Reprodutseeritav andmeanalüüs kasutades R programmi" />
  
  <meta name="twitter:description" content="Praktilise kursuse ‘Reprodutseeritav andmeanalüüs kasutades R programmi’ materjalid." />
  

<meta name="author" content="Taavi Päll, Ülo Maiväli">


<meta name="date" content="2017-09-17">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="calc.html">
<link rel="next" href="obj.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />








<script src="https://use.fontawesome.com/e4ba4259a1.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Reprodutseeritav andmeanalüüs R programmiga</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Haara kannel, Vanemuine!</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Sissejuhatus</a></li>
<li class="chapter" data-level="3" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>3</b> Tarkvaratööriistad</a><ul>
<li class="chapter" data-level="3.1" data-path="tools.html"><a href="tools.html#installeeri-vajalikud-programmid"><i class="fa fa-check"></i><b>3.1</b> Installeeri vajalikud programmid</a></li>
<li class="chapter" data-level="3.2" data-path="tools.html"><a href="tools.html#loo-githubi-konto"><i class="fa fa-check"></i><b>3.2</b> Loo GitHubi konto</a></li>
<li class="chapter" data-level="3.3" data-path="tools.html"><a href="tools.html#loo-uus-r-projekt"><i class="fa fa-check"></i><b>3.3</b> Loo uus R projekt</a></li>
<li class="chapter" data-level="3.4" data-path="tools.html"><a href="tools.html#git-merge-konfliktid"><i class="fa fa-check"></i><b>3.4</b> Git <em>Merge</em> konfliktid</a></li>
<li class="chapter" data-level="3.5" data-path="tools.html"><a href="tools.html#r-projekti-kataloogi-soovitatav-minimaalne-struktuur"><i class="fa fa-check"></i><b>3.5</b> R projekti kataloogi soovitatav minimaalne struktuur</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pakettide-installeerimine.html"><a href="pakettide-installeerimine.html"><i class="fa fa-check"></i><b>4</b> Pakettide installeerimine</a><ul>
<li class="chapter" data-level="4.1" data-path="pakettide-installeerimine.html"><a href="pakettide-installeerimine.html#r-repositooriumid"><i class="fa fa-check"></i><b>4.1</b> R repositooriumid</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="calc.html"><a href="calc.html"><i class="fa fa-check"></i><b>5</b> R on kalkulaator</a><ul>
<li class="chapter" data-level="5.1" data-path="calc.html"><a href="calc.html#r-objektid"><i class="fa fa-check"></i><b>5.1</b> R objektid</a></li>
<li class="chapter" data-level="5.2" data-path="calc.html"><a href="calc.html#objekt-ja-nimi"><i class="fa fa-check"></i><b>5.2</b> Objekt ja nimi</a></li>
<li class="chapter" data-level="5.3" data-path="calc.html"><a href="calc.html#nimede-vorm"><i class="fa fa-check"></i><b>5.3</b> Nimede vorm</a></li>
<li class="chapter" data-level="5.4" data-path="calc.html"><a href="calc.html#sama-koodi-saab-kirjutada-neljal-viisil"><i class="fa fa-check"></i><b>5.4</b> Sama koodi saab kirjutada neljal viisil</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="funs.html"><a href="funs.html"><i class="fa fa-check"></i><b>6</b> R on andmeanalüüsi keel, mille verbid on funktsioonid</a><ul>
<li class="chapter" data-level="6.1" data-path="funs.html"><a href="funs.html#kirjutame-oma-esimese-r-funktsiooni"><i class="fa fa-check"></i><b>6.1</b> Kirjutame oma esimese R funktsiooni</a></li>
<li class="chapter" data-level="6.2" data-path="funs.html"><a href="funs.html#funktsioonide-raamatukogud"><i class="fa fa-check"></i><b>6.2</b> Funktsioonide raamatukogud</a></li>
<li class="chapter" data-level="6.3" data-path="funs.html"><a href="funs.html#paiguta-koigi-raamatukogude-lugemine-koodi-algusesse"><i class="fa fa-check"></i><b>6.3</b> Paiguta kõigi raamatukogude lugemine koodi algusesse</a></li>
<li class="chapter" data-level="6.4" data-path="funs.html"><a href="funs.html#hurraa-uus-arvuti-aga-mis-libraryd-mul-olid"><i class="fa fa-check"></i><b>6.4</b> Hurraa, uus arvuti! aga mis libraryd mul olid…</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="obj.html"><a href="obj.html"><i class="fa fa-check"></i><b>7</b> Objektide tüübid</a><ul>
<li class="chapter" data-level="7.1" data-path="obj.html"><a href="obj.html#vektor"><i class="fa fa-check"></i><b>7.1</b> Vektor</a><ul>
<li class="chapter" data-level="7.1.1" data-path="obj.html"><a href="obj.html#uus-vektor-seq-ja-rep"><i class="fa fa-check"></i><b>7.1.1</b> Uus vektor: <code>seq()</code> ja <code>rep()</code></a></li>
<li class="chapter" data-level="7.1.2" data-path="obj.html"><a href="obj.html#tehted-arvuliste-vektoritega"><i class="fa fa-check"></i><b>7.1.2</b> Tehted arvuliste vektoritega</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="obj.html"><a href="obj.html#list"><i class="fa fa-check"></i><b>7.2</b> List</a></li>
<li class="chapter" data-level="7.3" data-path="obj.html"><a href="obj.html#data-frame-ja-tibble"><i class="fa fa-check"></i><b>7.3</b> data frame ja tibble</a><ul>
<li class="chapter" data-level="7.3.1" data-path="obj.html"><a href="obj.html#rekodeerime-tibble-vaartusi"><i class="fa fa-check"></i><b>7.3.1</b> Rekodeerime tibble väärtusi</a></li>
<li class="chapter" data-level="7.3.2" data-path="obj.html"><a href="obj.html#uhendame-kaks-tibblet-rea-kaupa"><i class="fa fa-check"></i><b>7.3.2</b> Ühendame kaks tibblet rea kaupa</a></li>
<li class="chapter" data-level="7.3.3" data-path="obj.html"><a href="obj.html#uhendame-kaks-tibblet-veeru-kaupa"><i class="fa fa-check"></i><b>7.3.3</b> ühendame kaks tibblet veeru kaupa</a></li>
<li class="chapter" data-level="7.3.4" data-path="obj.html"><a href="obj.html#nii-saab-tibblest-katte-vektori-millega-saab-tehteid-teha."><i class="fa fa-check"></i><b>7.3.4</b> Nii saab tibblest kätte vektori, millega saab tehteid teha.</a></li>
<li class="chapter" data-level="7.3.5" data-path="obj.html"><a href="obj.html#andmeraamide-salvestamine-eksport-import"><i class="fa fa-check"></i><b>7.3.5</b> Andmeraamide salvestamine (eksport-import)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="obj.html"><a href="obj.html#tabelit-sisse-lugedes-vaata-ule-na-d"><i class="fa fa-check"></i><b>7.4</b> Tabelit sisse lugedes vaata üle NA-d</a></li>
<li class="chapter" data-level="7.5" data-path="obj.html"><a href="obj.html#matrix"><i class="fa fa-check"></i><b>7.5</b> Matrix</a></li>
<li class="chapter" data-level="7.6" data-path="obj.html"><a href="obj.html#andmete-tuubid"><i class="fa fa-check"></i><b>7.6</b> Andmete tüübid</a></li>
<li class="chapter" data-level="7.7" data-path="obj.html"><a href="obj.html#indekseerimine"><i class="fa fa-check"></i><b>7.7</b> Indekseerimine</a><ul>
<li class="chapter" data-level="7.7.1" data-path="obj.html"><a href="obj.html#vektorid-ja-nende-indeksid-on-uhedimensionaalsed"><i class="fa fa-check"></i><b>7.7.1</b> Vektorid ja nende indeksid on ühedimensionaalsed</a></li>
<li class="chapter" data-level="7.7.2" data-path="obj.html"><a href="obj.html#andmeraamid-ja-maatriksid-on-kahedimensionaalsed-nagu-ka-nende-indeksid"><i class="fa fa-check"></i><b>7.7.2</b> Andmeraamid ja maatriksid on kahedimensionaalsed, nagu ka nende indeksid</a></li>
<li class="chapter" data-level="7.7.3" data-path="obj.html"><a href="obj.html#listide-indekseerimine"><i class="fa fa-check"></i><b>7.7.3</b> Listide indekseerimine</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="obj.html"><a href="obj.html#regular-expression-ja-find-replace"><i class="fa fa-check"></i><b>7.8</b> Regular expression ja find &amp; replace</a><ul>
<li class="chapter" data-level="7.8.1" data-path="obj.html"><a href="obj.html#common-operations-with-regular-expressions"><i class="fa fa-check"></i><b>7.8.1</b> Common operations with regular expressions</a></li>
<li class="chapter" data-level="7.8.2" data-path="obj.html"><a href="obj.html#find-and-replace"><i class="fa fa-check"></i><b>7.8.2</b> Find and replace</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>8</b> Tidyverse</a><ul>
<li class="chapter" data-level="8.1" data-path="tidyverse.html"><a href="tidyverse.html#tidy-tabeli-struktuur"><i class="fa fa-check"></i><b>8.1</b> Tidy tabeli struktuur</a><ul>
<li class="chapter" data-level="8.1.1" data-path="tidyverse.html"><a href="tidyverse.html#tabeli-dimensioonide-muutmine-pikk-ja-lai-formaat"><i class="fa fa-check"></i><b>8.1.1</b> Tabeli dimensioonide muutmine (pikk ja lai formaat)</a></li>
<li class="chapter" data-level="8.1.2" data-path="tidyverse.html"><a href="tidyverse.html#tibble-transpose-read-veergudeks-ja-vastupidi"><i class="fa fa-check"></i><b>8.1.2</b> Tibble transpose — read veergudeks ja vastupidi</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tidyverse.html"><a href="tidyverse.html#dplyr-ja-selle-viis-verbi"><i class="fa fa-check"></i><b>8.2</b> dplyr ja selle viis verbi</a><ul>
<li class="chapter" data-level="8.2.1" data-path="tidyverse.html"><a href="tidyverse.html#select-columns"><i class="fa fa-check"></i><b>8.2.1</b> <code>select()</code> columns</a></li>
<li class="chapter" data-level="8.2.2" data-path="tidyverse.html"><a href="tidyverse.html#filter-rows"><i class="fa fa-check"></i><b>8.2.2</b> <code>filter()</code> rows</a></li>
<li class="chapter" data-level="8.2.3" data-path="tidyverse.html"><a href="tidyverse.html#summarise"><i class="fa fa-check"></i><b>8.2.3</b> <code>summarise()</code></a></li>
<li class="chapter" data-level="8.2.4" data-path="tidyverse.html"><a href="tidyverse.html#group_by"><i class="fa fa-check"></i><b>8.2.4</b> <code>group_by()</code></a></li>
<li class="chapter" data-level="8.2.5" data-path="tidyverse.html"><a href="tidyverse.html#mutate"><i class="fa fa-check"></i><b>8.2.5</b> <code>mutate()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="tidyverse.html"><a href="tidyverse.html#grouped-filters"><i class="fa fa-check"></i><b>8.3</b> Grouped filters</a></li>
<li class="chapter" data-level="8.4" data-path="tidyverse.html"><a href="tidyverse.html#separate-one-column-into-several"><i class="fa fa-check"></i><b>8.4</b> <code>separate()</code> one column into several</a></li>
<li class="chapter" data-level="8.5" data-path="tidyverse.html"><a href="tidyverse.html#faktorid"><i class="fa fa-check"></i><b>8.5</b> Faktorid</a><ul>
<li class="chapter" data-level="8.5.1" data-path="tidyverse.html"><a href="tidyverse.html#fct_recode-rekodeerib-faktori-tasemed"><i class="fa fa-check"></i><b>8.5.1</b> <code>fct_recode()</code> rekodeerib faktori tasemed</a></li>
<li class="chapter" data-level="8.5.2" data-path="tidyverse.html"><a href="tidyverse.html#fct_collapse-annab-argumenti-sisse-vanade-tasemete-vektori-et-teha-vahem-uusi-tasemeid."><i class="fa fa-check"></i><b>8.5.2</b> <code>fct_collapse()</code> annab argumenti sisse vanade tasemete vektori, et teha vähem uusi tasemeid.</a></li>
<li class="chapter" data-level="8.5.3" data-path="tidyverse.html"><a href="tidyverse.html#fct_lump-loob-kokku-koik-vahem-arv-kordi-esinevad-tasemed."><i class="fa fa-check"></i><b>8.5.3</b> <code>fct_lump()</code> lööb kokku kõik vähem arv kordi esinevad tasemed.</a></li>
<li class="chapter" data-level="8.5.4" data-path="tidyverse.html"><a href="tidyverse.html#rekodeerime-pideva-muutuja-faktoriks"><i class="fa fa-check"></i><b>8.5.4</b> Rekodeerime pideva muutuja faktoriks</a></li>
<li class="chapter" data-level="8.5.5" data-path="tidyverse.html"><a href="tidyverse.html#muudame-faktori-tasemete-jarjekorda-joonisel"><i class="fa fa-check"></i><b>8.5.5</b> Muudame faktori tasemete järjekorda joonisel</a></li>
<li class="chapter" data-level="8.5.6" data-path="tidyverse.html"><a href="tidyverse.html#fct_relevel-tostab-joonisel-osad-tasemed-teistest-ettepoole"><i class="fa fa-check"></i><b>8.5.6</b> <code>fct_relevel()</code> tõstab joonisel osad tasemed teistest ettepoole</a></li>
<li class="chapter" data-level="8.5.7" data-path="tidyverse.html"><a href="tidyverse.html#joontega-plotil-saab-fct_reorder2-abil-assotseerida-y-vaartused-suurimate-x-vaartustega"><i class="fa fa-check"></i><b>8.5.7</b> Joontega plotil saab <code>fct_reorder2()</code> abil assotseerida y väärtused suurimate x väärtustega</a></li>
<li class="chapter" data-level="8.5.8" data-path="tidyverse.html"><a href="tidyverse.html#tulpdiagrammide-korral-kasuta-fct_infreq"><i class="fa fa-check"></i><b>8.5.8</b> Tulpdiagrammide korral kasuta <code>fct_infreq()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliograafia.html"><a href="bibliograafia.html"><i class="fa fa-check"></i>Bibliograafia</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstats-tartu/lectures" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reprodutseeritav andmeanalüüs kasutades R programmi</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="funs" class="section level1">
<h1><span class="header-section-number">6</span> R on andmeanalüüsi keel, mille verbid on funktsioonid</h1>
<p>Kasutaja ütleb nii täpselt kui oskab, mida ta tahab ja R-s elab kratt, kes püüab ära arvata, mida on vaja teha. Vahest teeb kah. Vahest isegi seda, mida kasutaja tahtis. Mõni arvab, et R-i puudus on veateadete puudumine või krüptilised veateated. Sama kehtib ka R-i helpi kohta. Seega tasub alati kontrollida, kas R ikka tegi seda, mida sina talle enda arust ette kirjutasid.</p>
<p>Paljudel juhtudel ütleb (hea) funktsiooni nimi mida see teeb:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create two test vectors</span>
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">7</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate correlation</span>
<span class="kw">cor</span>(x, y)</code></pre></div>
<pre><code>## [1] -0.1166019</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate sum</span>
<span class="kw">sum</span>(x)</code></pre></div>
<pre><code>## [1] 21</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate sum of two vectors</span>
<span class="kw">sum</span>(x, y)</code></pre></div>
<pre><code>## [1] 38</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate average</span>
<span class="kw">mean</span>(x)</code></pre></div>
<pre><code>## [1] 4.2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate median</span>
<span class="kw">median</span>(x)</code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate standard deviation</span>
<span class="kw">sd</span>(x)</code></pre></div>
<pre><code>## [1] 1.30384</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># return quantiles</span>
<span class="kw">quantile</span>(x)</code></pre></div>
<pre><code>##   0%  25%  50%  75% 100% 
##    3    3    4    5    6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># return maximum value</span>
<span class="kw">max</span>(x)</code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># return minimum value</span>
<span class="kw">min</span>(x)</code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>R-is teevad asju programmikesed, mida kutsutakse <strong>funktsioonideks</strong>. Te võite mõelda funktsioonist nagu verbist. Näiteks funktsiooni <code>sum()</code> korral loe: “võta summa”. Iga funktsiooni nime järel on sulud. Nende sulgude sees asuvad selle funktsiooni <strong>argumendid</strong>. Argumendid määravad ära funktsiooni käitumise. Et näha, millised argumendid on funktsiooni käivitamiseks vajalikud ja milliseid on üldse võimalik seadistada, kasuta ‘help’ käsku.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?sum</code></pre></div>
<p>Help paneelis paremal all ilmub nüüd selle funktsiooni R dokumentatsioon. Vaata seal peatükki Usage: <code>sum(..., na.rm = FALSE)</code> ja edasi peatükki Arguments, mis ütleb, et <code>...</code> (ellipsis) tähistab vektoreid.</p>
<pre><code>sum {base}  R Documentation 
Sum of Vector Elements

Description:

sum returns the sum of all the values present in its arguments.

Usage

sum(..., na.rm = FALSE)

Arguments

... - numeric or complex or logical vectors.

na.rm   - logical. Should missing values (including NaN) be removed?</code></pre>
<p>Seega võtab funktsioon <code>sum()</code> kaks argumenti: vektori arvudest (või loogilise vektori, mis koosneb TRUE ja FALSE määrangutest), ning “na.rm” argumendi, millele saab anda väärtuseks kas, TRUE või FALSE. Usage ütleb ka, et vaikimisi on <code>na.rm = FALSE</code>, mis tähendab, et sellele argumendile on antud vaikeväärtus – kui me seda ise ei muuda, siis jäävad NA-d arvutusse sisse. Kuna NA tähendab “tundmatu arv” siis iga tehe NA-dega annab vastuseks “tundmatu arv” ehk NA (tundmatu arv + 2 = tundmatu arv). Seega NA tulemus annab märku, et teie andmetes võib olla midagi valesti.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## moodustame vektori
apples &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">34</span>, <span class="dv">43</span>, <span class="ot">NA</span>)
## arvutame summa
<span class="kw">sum</span>(apples, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 78</code></pre>
<p>Niimoodi saab arvutada summat vektorile nimega “apples”.</p>
<p>Sisestades R käsureale funktsiooni ilma selle sulgudeta saab masinast selle funktsiooni koodi. Näiteks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum</code></pre></div>
<pre><code>## function (..., na.rm = FALSE)  .Primitive(&quot;sum&quot;)</code></pre>
<p>Tulemus näitab, et <code>sum()</code> on <code>Primitive</code> funktsioon, mis põhimõtteliselt tähendab, et ta põhineb C koodil ja ei kasuta R koodi.</p>
<div id="kirjutame-oma-esimese-r-funktsiooni" class="section level2">
<h2><span class="header-section-number">6.1</span> Kirjutame oma esimese R funktsiooni</h2>
<p>Võib ju väita, et funktsiooni ainus mõte on peita teie eest korduvad vajalikud koodiread kood funktsiooni nime taha. Põhjus, miks R-s on funktsioonid, on korduse vähendamine, koodi loetavaks muutmine ja seega ka ruumi kokkuhoid. Koodi funktsioonidena kasutamine suurendab analüüside reprodutseeritavust, kuna funktsioonis olev kood pärineb ühest allikast, mitte ei ole paljude koopiatena igal pool laiali. See muudab pikad koodilõigud hõlpsalt taaskasutatavaks sest lihtsam on kirjutada lühike funktsiooni nimi ja sisestada selle funktsiooni argumendid. Koodi funktsioonidesse kokku surumine vähendab võimalusi lollideks vigadeks, mida te võite teha pikkade koodijuppidega manipuleerides. Seega tasub teil õppida ka oma korduvaid koodiridu funktsioonidena vormistama.</p>
<p>Kõige pealt kirjutame natuke koodi.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># two apples</span>
apples &lt;-<span class="st"> </span><span class="dv">2</span>
<span class="co"># three oranges</span>
oranges &lt;-<span class="st"> </span><span class="dv">3</span> 
<span class="co"># parentheses around expression assigning result to an object </span>
<span class="co"># ensure that result is also printed to R console</span>
(inventory &lt;-<span class="st"> </span>apples <span class="op">+</span><span class="st"> </span>oranges)</code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>Ja nüüd pakendame selle tehte funktsiooni <code>add2()</code>. Funktsiooni defineerimiseks kasutame järgmist r ekspressiooni <code>function( arglist ) expr</code>, kus “arglist” on tühi või ühe või rohkema nimega argumenti kujul <code>name=expression</code>; “expr” on R-i ekspressioon st. kood mida see funktsioon käivitab. Funktsiooni viimane evlueeritav koodirida on see, mis tuleb välja selle funktsiooni outputina.</p>
<p>All toodud näites on selleks <code>x + y</code> tehte vastus.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">add2 &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {
    x <span class="op">+</span><span class="st"> </span>y
}</code></pre></div>
<p>Seda koodi jooksutades näeme, et meie funktsioon ilmub R-i Environmenti, kuhu tekib Functions lahter. Seal on näha ka selle funktsiooni kaks argumenti, apples ja oranges.</p>
<p>Antud funktsiooni käivitamine annab veateate, sest funktsiooni argumentidel pole väärtusi:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## run function in failsafe mode
inventory &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">add2</span>())
## when function fails, error message is returned
<span class="kw">class</span>(inventory)</code></pre></div>
<pre><code>## [1] &quot;try-error&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## print error message
<span class="kw">cat</span>(inventory)</code></pre></div>
<pre><code>## Error in add2() : argument &quot;x&quot; is missing, with no default</code></pre>
<p>Andes funktsiooni argumentidele väärtused, saab väljundi:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## run function with proper arguments
inventory &lt;-<span class="st"> </span><span class="kw">add2</span>(<span class="dt">x =</span> apples, <span class="dt">y =</span> oranges)
## numeric vector is returned
<span class="kw">class</span>(inventory)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## result
inventory</code></pre></div>
<pre><code>## [1] 5</code></pre>
<p><strong>Nüüd midagi kasulikumat.</strong></p>
<p>Funktsioon standrardvea arvutamiseks (baas R-s sellist funktsiooni ei ole): <code>sd()</code> funktsioon arvutab standardhälbe. Sellel on kaks argumenti: x and na.rm. Me teame, et SEM=SD/sqrt(N) kus N = length(x)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">calc_sem &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  stdev &lt;-<span class="st"> </span><span class="kw">sd</span>(x)
  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)
  stdev <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)
}</code></pre></div>
<p>x hoiab lihtsalt kohta andmetele, mida me tahame sinna funktsiooni suunata. <code>sd()</code>, <code>sqrt()</code> ja <code>length()</code> on olemasolevad baas R funktsioonid, mille me oma funktsiooni hõlmame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## create numeric vector
numbers &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="fl">3.4</span>, <span class="dv">54</span>, <span class="ot">NA</span>, <span class="dv">3</span>)
<span class="kw">calc_sem</span>(numbers)</code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>No jah, kui meil on andmetes tundmatu arv (<code>NA</code>) siis on ka tulemuseks tundmatu arv.</p>
<p>Sellisel juhul tuleb NA väärtused vektorist enne selle funktsiooni kasutamist välja visata:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">numbers_filtered &lt;-<span class="st"> </span><span class="kw">na.omit</span>(numbers)
<span class="kw">calc_sem</span>(numbers_filtered)</code></pre></div>
<pre><code>## [1] 12.80338</code></pre>
<p>On ka võimalus funktsiooni sisse kirjutada <strong>NA väärtuste käsitlemine</strong>. Näiteks, üks võimalus on <strong>anda viga</strong> ja funktsioon katkestada, et kasutaja saaks ise ühemõtteliselt oma andmetest NA väärtused eemaldada. Teine võimalus on funktsioonis <strong>NA-d vaikimisi eemaldada</strong> ja anda selle kohta näiteks teade.</p>
<p>NA-de vaikimisi eemaldamiseks on hetkel mitu võimalust, kasutame kõigepealt nö. valet lahendust:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">calc_sem &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  ## kasutame sd funktsiooni argumenti na.rm
  stdev &lt;-<span class="st"> </span><span class="kw">sd</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)
  stdev <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)
}

<span class="kw">calc_sem</span>(numbers)</code></pre></div>
<pre><code>## [1] 11.4517</code></pre>
<p>See annab meile vale tulemuse sest <code>na.rm = TRUE</code> viskab küll NA-d välja meie vektorist aga jätab vektori pikkuse muutmata (<code>length(x)</code> rida).</p>
<p>Teeme uue versiooni oma funktsioonist, mis viskab vaikimisi välja puuduvad väärtused, kui need on olemas ja annab siis ka selle kohta hoiatuse.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## x on numbriline vektor
calc_sem &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  
  ## viskame NA väärtused vektorist välja
  x &lt;-<span class="st"> </span><span class="kw">na.omit</span>(x)
  
  ## kui vektoris on NA väärtusi, siis hoiatame kasutajat
  <span class="cf">if</span>(<span class="kw">inherits</span>(<span class="kw">na.action</span>(x), <span class="st">&quot;omit&quot;</span>)) {
    <span class="kw">warning</span>(<span class="st">&quot;Removed NAs from vector.</span><span class="ch">\n</span><span class="st">&quot;</span>)
  }
  
  ## arvutame standardvea kasutades filtreeritud vektorit
  stdev &lt;-<span class="st"> </span><span class="kw">sd</span>(x)
  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)
  stdev <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)
}

<span class="kw">calc_sem</span>(numbers)</code></pre></div>
<pre><code>## Warning in calc_sem(numbers): Removed NAs from vector.</code></pre>
<pre><code>## [1] 12.80338</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(numbers)</code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>Missugune funktsiooni käitumine valida, sõltub kasutaja vajadusest. Rohkem infot NA käsitlemise funktsioonide kohta saab <code>?na.omit</code> abifailist.</p>
<p>Olgu see õpetuseks, et funktsioonide kirjutamine on järk-järguline protsess ja sellele, et alati saab paremini teha.</p>
</div>
<div id="funktsioonide-raamatukogud" class="section level2">
<h2><span class="header-section-number">6.2</span> Funktsioonide raamatukogud</h2>
<p>Kõige esimene sõnum <code>sum()</code> help lehel on “sum {base}”, mis tähendab, et see funktsioon kuulub nn. baasfunktsioonide hulka. Need funktsioonid on alati kättesaadavad sest neid sisaldavad raamatukogud laetakse vaikimisi teie töökeskkonda. Näiteks “base” raamatukogu versioon 3.4.1 sisaldab 453 funktsiooni. Enamasti on sarnaseid asju tegevad funktsioonid koondatud kokku raamatukogudesse ehk pakettidesse, mis tuleb eraldi R kesksest repositooriumist <a href="https://cran.r-project.org">CRAN</a> alla laadida ja installeerida.</p>
<p>Selleks, et kasutada raamatukogudes leiduvaid funktsioone, tuleb kõigepealt antud raamatukogu oma arvutisse alla laadida (seda peab tegema ainult üks kord) ja seejärel see raamatukogu töökeskkond sisse lugeda (seda tuleb teha igal R sessioonil, kus me vastava raamatukogu funktsioone kasutame).</p>
<p>Näiteks, hea laps ei lahku kunagi kodust ilma raamatukogu “tidyverse”-ta.</p>
<p>Kõigepealt installeerime selle oma arvutisse.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</code></pre></div>
<p>NB! kui mõni raamatukogu sel viisil alla ei tule, siis guugeldage selle nime + R ja vaadake instruktsioone allalaadimiseks.</p>
<p>Raamatukogud elavad <em>repositorides</em>, millest suurim on CRAN. <code>install.packages()</code> otsib, laadib alla ja installeerib teie soovitud raamatukogu just sealt. Teised suuremad repod on GitHub <a href="https://github.com" class="uri">https://github.com</a>, kus elab sageli R pakettide source kood ja dev versioonid, ja Bioconductor (seal on tuhandeid bioloogiliseks analüüsiks vajalikke pakette). Neist allalaadimine on pisut erinev, aga mitte kuigi keeruline. Kõigi pakettide kohta on võrgus ka allalaadimise õpetus. Googeldage paketi nime järgi.</p>
<p>Nüüd on teil <code>tidyverse</code> pakett arvutis. Tegelikult kuuluvad siia raamatukokku omakorda tosinkond raamatukogu — tidyverse on pisut meta. Igal juhul muutuvad selle funktsioonid kättesaadavaks peale seda, kui te need töökeskkonda sisse loete</p>
<p>Veel üks tehniline detail. <code>library(tidyverse)</code> käsk ei loe sisse kõiki alam-raamatukogusid, mis selle nime all CRAN-ist alla laaditi. Need tuleb vajadusel eraldi ükshaaval sisse lugeda.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<pre><code>## Loading tidyverse: ggplot2
## Loading tidyverse: tibble
## Loading tidyverse: readr
## Loading tidyverse: purrr
## Loading tidyverse: dplyr</code></pre>
<pre><code>## Conflicts with tidy packages ----------------------------------------------</code></pre>
<pre><code>## filter(): dplyr, stats
## lag():    dplyr, stats</code></pre>
<p>Antud kursuse raames tuleb seda teha iga kord, kui te R sessiooni alustate. Pakette/library-sid on soovitav laadida töökeskkonda muidu ikka ainult vastavalt vajadusele. “tidyverse”-gi puhul on soovitatav eelistatult laadida ainult see/need raamatukogud, mida tegelikult kasutama ka hakatakse. Vaikimisi kogu aeg kogu “tiduverse” rammatukogu laadimine ei pruugi olla reprodutseeritavuse mõttes hea, sest paratamatult võivad tekkida konfliktid teiste mitte-tidyverse raamatukogude funktsioonidega. Näiteks on <code>select()</code> funktsioon lisaks “dplyr” librarile olemas ka mitmes teises paketis.</p>
<p>Konfliktide korral eri pakettide sama nimega funktsioonide vahel saab <code>::</code> operaatorit kasutades kutsuda välja/importida funktsiooni spetsiifilisest paketist:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tidyr<span class="op">::</span><span class="kw">select</span>(df, my_var)</code></pre></div>
<p>Sellisel kujul funktsioonide kasutamisel pole vaja imporditavat funktsiooni sisaldavat raamatukogu töökeskkonda laadida.</p>
</div>
<div id="paiguta-koigi-raamatukogude-lugemine-koodi-algusesse" class="section level2">
<h2><span class="header-section-number">6.3</span> Paiguta kõigi raamatukogude lugemine koodi algusesse</h2>
<p>Enamasti kirjutatakse sisse loetavad raamatukogud kohe R scripti algusesse. Siis on teile endale ja teistele kes teie koodi loevad ilusti näha, mida hiljem vaja läheb.</p>
<p>Kui te lähete RStudios paremal all olevale “Packages” tabile, siis on võimalik klikkida raamatukogu nimele ja näha selle help-faile, tutooriale ja kõiki selle raamatukogu funktsioone koos nende help failidega.</p>
<p>Nüüd võite näiteks kasutada funktsiooni <code>drop_na()</code>, mis eemaldab teie andmetabelist read, mis sisaldavad NA-sid. See funktsioon asub “tidyr” raamatukogus, mis koos ülejäänud “tidyverse”-ga sisse loeti.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?drop_na</code></pre></div>
<p>Verb: <code>drop_na()</code> loe: “viska NA-d välja”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># creates a two-column table</span>
df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">apples =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="ot">NA</span>, <span class="dv">5</span>), <span class="dt">oranges =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="ot">NA</span>, <span class="dv">6</span>, <span class="dv">4</span>)) 
df</code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   apples oranges
##    &lt;dbl&gt;   &lt;dbl&gt;
## 1      2       4
## 2      3      NA
## 3     NA       6
## 4      5       4</code></pre>
<p>Nüüd filtreerime tabelist välja selle rea mis sisaldavad NA väärtusi tulbas “apples”. Tabeli mõlemas tulbas on üks NA, seega jääb tabelisse tulbas “oranges” NA-d sisaldav rida alles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df1 &lt;-<span class="st"> </span><span class="kw">drop_na</span>(df, apples) 
df1</code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   apples oranges
##    &lt;dbl&gt;   &lt;dbl&gt;
## 1      2       4
## 2      3      NA
## 3      5       4</code></pre>
</div>
<div id="hurraa-uus-arvuti-aga-mis-libraryd-mul-olid" class="section level2">
<h2><span class="header-section-number">6.4</span> Hurraa, uus arvuti! aga mis libraryd mul olid…</h2>
<p>Kui te uuendate oma R versiooni või olete ostnud uue arvuti, siis lähevad kaduma kõik teie paketid. Nende automaatseks allalaadimiseks võite teha nii:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## in the old version/machine run:
installed &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">installed.packages</span>())
<span class="kw">write.csv</span>(installed, <span class="st">&quot;data/installed_previously.csv&quot;</span>)

## when new machine, move &quot;data/installed_previously.csv&quot; into new computer

## and in the new one:
installedPreviously &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/installed_previously.csv&quot;</span>)
baseR &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">installed.packages</span>())
toInstall &lt;-<span class="st"> </span><span class="kw">setdiff</span>(installedPreviously<span class="op">$</span>Package, baseR<span class="op">$</span>Package)
<span class="kw">install.packages</span>(toInstall) </code></pre></div>
<p>Tundub juskui tark ja mõistlik, kuid:</p>
<ul>
<li>Massiline pakettide installatsioon uude arvutisse võib kergesti takerduda erinevate R-i väliste sõltuvuste taha ja tekitab frustratsiooni.</li>
<li>Lisaks, ebavajalikest pakettidest vabanemiseks on mõistlik vajaminevad paketid jooksvalt tagasi installeerida.</li>
<li>Kiire internet on laialt saadaval ja ka kompileeritavad paketid ei võta installatsiooniks rohkem kui mõni minut aega.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="calc.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="obj.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstats-tartu/lectures/edit/master/04-funktsioonid.Rmd",
"text": "Edit"
},
"download": ["main.pdf", "main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
